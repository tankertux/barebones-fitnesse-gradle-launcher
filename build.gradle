apply plugin: 'java'

repositories {
    jcenter()
}

ext{
	port = getPropertyWithDefault('port', "8080")
}

public String getPropertyWithDefault(String propName, String defaultValue){
	return has(propName) ? get(propName) : defaultValue
}

configurations{
	fitnesse
	startup
	compile.extendsFrom fitnesse
}

dependencies {
	fitnesse 'org.fitnesse:fitnesse:20150424'

	compile 'org.slf4j:slf4j-api:1.7.12'

    testCompile 'junit:junit:4.12'
}

task startFit(type: JavaExec) {
	def receiptRunnerDir = file(".")
	def relativePathToFitnesseRoot = receiptRunnerDir.toPath().relativize(file('src/test/fitnesse').toPath())
	main = 'fitnesseMain.FitNesseMain'
	args  '-p', port, '-r', relativePathToFitnesseRoot, '-f', "${relativePathToFitnesseRoot}/plugins.properties"
	classpath configurations.fitnesse
}
